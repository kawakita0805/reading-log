<!DOCTYPE html>

<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>èª­æ›¸è¨˜éŒ²</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="èª­æ›¸è¨˜éŒ²" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=DM+Serif+Display&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    html, body { background: #1a1208; min-height: 100vh; }
  </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useRef } = React;

const STORAGE_KEY = â€œreading-log-booksâ€;

const formatTime = (seconds) => {
const h = Math.floor(seconds / 3600);
const m = Math.floor((seconds % 3600) / 60);
const s = seconds % 60;
if (h > 0) return `${h}æ™‚é–“${m}åˆ†`;
if (m > 0) return `${m}åˆ†${s}ç§’`;
return `${s}ç§’`;
};

const formatDate = (dateStr) => {
if (!dateStr) return â€œâ€”â€;
return new Date(dateStr).toLocaleDateString(â€œja-JPâ€, { year: â€œnumericâ€, month: â€œshortâ€, day: â€œnumericâ€ });
};

const today = () => new Date().toISOString().split(â€œTâ€)[0];

const css = `.app { font-family: 'Noto Serif JP', serif; background: #1a1208; min-height: 100vh; max-width: 430px; margin: 0 auto; color: #f5ead8; position: relative; } .header { padding: 56px 24px 20px; border-bottom: 1px solid rgba(245,234,216,0.12); } .header-title { font-family: 'DM Serif Display', serif; font-size: 28px; letter-spacing: 0.02em; color: #f5ead8; } .header-sub { font-size: 11px; color: #a0906e; margin-top: 4px; letter-spacing: 0.1em; text-transform: uppercase; } .content { padding: 20px 20px 100px; } .fab { position: fixed; bottom: 32px; right: 24px; width: 58px; height: 58px; border-radius: 50%; background: linear-gradient(135deg, #c9934a, #e8b86d); border: none; color: #1a1208; font-size: 28px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 20px rgba(201,147,74,0.4); cursor: pointer; z-index: 10; } .book-card { background: rgba(245,234,216,0.05); border: 1px solid rgba(245,234,216,0.1); border-radius: 12px; padding: 16px 18px; margin-bottom: 12px; cursor: pointer; } .book-title { font-size: 16px; font-weight: 700; color: #f5ead8; line-height: 1.4; } .book-author { font-size: 12px; color: #a0906e; margin-top: 3px; } .progress-bar-bg { height: 4px; background: rgba(245,234,216,0.1); border-radius: 2px; margin-top: 12px; } .progress-bar-fill { height: 4px; background: linear-gradient(90deg, #c9934a, #e8b86d); border-radius: 2px; transition: width 0.5s; } .progress-label { font-size: 11px; color: #a0906e; margin-top: 6px; display: flex; justify-content: space-between; } .back-btn { display: flex; align-items: center; gap: 6px; background: none; border: none; color: #c9934a; font-size: 14px; font-family: 'Noto Serif JP', serif; cursor: pointer; padding: 0; margin-bottom: 20px; } .section-title { font-size: 11px; letter-spacing: 0.15em; text-transform: uppercase; color: #a0906e; margin: 24px 0 12px; } .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; } .stat-box { background: rgba(245,234,216,0.05); border: 1px solid rgba(245,234,216,0.1); border-radius: 10px; padding: 14px; } .stat-val { font-family: 'DM Serif Display', serif; font-size: 22px; color: #e8b86d; } .stat-key { font-size: 11px; color: #a0906e; margin-top: 4px; } .session-item { border-left: 2px solid rgba(201,147,74,0.4); padding: 10px 14px; margin-bottom: 10px; } .session-date { font-size: 11px; color: #a0906e; } .session-stats { font-size: 14px; color: #f5ead8; margin-top: 3px; } .action-btn { width: 100%; padding: 14px; border-radius: 10px; border: none; cursor: pointer; font-family: 'Noto Serif JP', serif; font-size: 15px; font-weight: 700; } .btn-primary { background: linear-gradient(135deg, #c9934a, #e8b86d); color: #1a1208; } .btn-secondary { background: rgba(245,234,216,0.08); color: #f5ead8; border: 1px solid rgba(245,234,216,0.15); } .btn-danger { background: rgba(220,60,60,0.15); color: #e86d6d; border: 1px solid rgba(220,60,60,0.2); margin-top: 10px; } .input { width: 100%; background: rgba(245,234,216,0.06); border: 1px solid rgba(245,234,216,0.15); border-radius: 10px; padding: 13px 14px; color: #f5ead8; font-family: 'Noto Serif JP', serif; font-size: 15px; margin-bottom: 12px; outline: none; } .input:focus { border-color: #c9934a; } .input::placeholder { color: #6b5c40; } label { font-size: 12px; color: #a0906e; display: block; margin-bottom: 6px; } .timer-display { text-align: center; padding: 28px 0; } .timer-num { font-family: 'DM Serif Display', serif; font-size: 56px; color: #e8b86d; letter-spacing: 0.04em; line-height: 1; } .timer-sub { font-size: 12px; color: #a0906e; margin-top: 8px; letter-spacing: 0.1em; } .timer-btns { display: flex; gap: 10px; margin-bottom: 24px; } .timer-btn { flex: 1; } .empty { text-align: center; padding: 60px 0; color: #6b5c40; font-size: 14px; line-height: 1.8; } .empty-icon { font-size: 48px; margin-bottom: 16px; } .badge { display: inline-block; padding: 2px 8px; border-radius: 20px; font-size: 11px; margin-left: 8px; } .badge-done { background: rgba(100,200,120,0.15); color: #7dd87d; border: 1px solid rgba(100,200,120,0.25); } .badge-reading { background: rgba(201,147,74,0.15); color: #e8b86d; border: 1px solid rgba(201,147,74,0.25); }`;

function App() {
const [books, setBooks] = useState(() => {
try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || []; } catch { return []; }
});
const [view, setView] = useState(â€œlistâ€);
const [selectedId, setSelectedId] = useState(null);
const [addForm, setAddForm] = useState({ title: â€œâ€, author: â€œâ€, totalPages: â€œâ€ });
const [sessionForm, setSessionForm] = useState({ pages: â€œâ€, notes: â€œâ€ });
const [timer, setTimer] = useState(0);
const [running, setRunning] = useState(false);
const timerRef = useRef(null);

useEffect(() => {
localStorage.setItem(STORAGE_KEY, JSON.stringify(books));
}, [books]);

useEffect(() => {
if (running) {
timerRef.current = setInterval(() => setTimer((t) => t + 1), 1000);
} else {
clearInterval(timerRef.current);
}
return () => clearInterval(timerRef.current);
}, [running]);

const selectedBook = books.find((b) => b.id === selectedId);

const addBook = () => {
if (!addForm.title.trim() || !addForm.totalPages) return;
const newBook = {
id: Date.now().toString(),
title: addForm.title.trim(),
author: addForm.author.trim(),
totalPages: parseInt(addForm.totalPages),
startDate: today(),
endDate: null,
sessions: [],
};
setBooks((prev) => [newBook, â€¦prev]);
setAddForm({ title: â€œâ€, author: â€œâ€, totalPages: â€œâ€ });
setView(â€œlistâ€);
};

const saveSession = () => {
const pages = parseInt(sessionForm.pages) || 0;
setBooks((prev) =>
prev.map((b) => {
if (b.id !== selectedId) return b;
const sessions = [â€¦b.sessions, { date: today(), duration: timer, pages, notes: sessionForm.notes }];
const totalRead = sessions.reduce((sum, s) => sum + s.pages, 0);
const endDate = totalRead >= b.totalPages ? today() : null;
return { â€¦b, sessions, endDate: endDate || b.endDate };
})
);
setTimer(0); setRunning(false);
setSessionForm({ pages: â€œâ€, notes: â€œâ€ });
setView(â€œdetailâ€);
};

const deleteBook = (id) => {
if (!window.confirm(â€œã“ã®æœ¬ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿâ€)) return;
setBooks((prev) => prev.filter((b) => b.id !== id));
setView(â€œlistâ€);
};

const getStats = (book) => {
const totalReadTime = book.sessions.reduce((sum, s) => sum + s.duration, 0);
const readPages = book.sessions.reduce((sum, s) => sum + s.pages, 0);
const progress = book.totalPages > 0 ? Math.min((readPages / book.totalPages) * 100, 100) : 0;
return { totalReadTime, readPages, progress };
};

if (view === â€œaddâ€) return (
<div className="app">
<style>{css}</style>
<div className="header"><div className="header-title">æ–°ã—ã„æœ¬ã‚’ç™»éŒ²</div></div>
<div className="content">
<button className=â€œback-btnâ€ onClick={() => setView(â€œlistâ€)}>â† æˆ»ã‚‹</button>
<label>ã‚¿ã‚¤ãƒˆãƒ« *</label>
<input className=â€œinputâ€ placeholder=â€œæœ¬ã®ã‚¿ã‚¤ãƒˆãƒ«â€ value={addForm.title} onChange={(e) => setAddForm((f) => ({ â€¦f, title: e.target.value }))} />
<label>è‘—è€…</label>
<input className=â€œinputâ€ placeholder=â€œè‘—è€…åâ€ value={addForm.author} onChange={(e) => setAddForm((f) => ({ â€¦f, author: e.target.value }))} />
<label>ç·ãƒšãƒ¼ã‚¸æ•° *</label>
<input className=â€œinputâ€ type=â€œnumberâ€ placeholder=â€œä¾‹ï¼š320â€ value={addForm.totalPages} onChange={(e) => setAddForm((f) => ({ â€¦f, totalPages: e.target.value }))} />
<div style={{ height: 8 }} />
<button className="action-btn btn-primary" onClick={addBook}>ç™»éŒ²ã™ã‚‹</button>
</div>
</div>
);

if (view === â€œsessionâ€ && selectedBook) {
const h = Math.floor(timer / 3600).toString().padStart(2, â€œ0â€);
const m = Math.floor((timer % 3600) / 60).toString().padStart(2, â€œ0â€);
const s = (timer % 60).toString().padStart(2, â€œ0â€);
return (
<div className="app">
<style>{css}</style>
<div className="header">
<div className="header-sub">Reading Session</div>
<div className=â€œheader-titleâ€ style={{ fontSize: 18, marginTop: 4 }}>{selectedBook.title}</div>
</div>
<div className="content">
<button className=â€œback-btnâ€ onClick={() => { setRunning(false); setTimer(0); setView(â€œdetailâ€); }}>â† ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
<div className="timer-display">
<div className="timer-num">{h}:{m}:{s}</div>
<div className="timer-sub">èª­æ›¸ã‚¿ã‚¤ãƒãƒ¼</div>
</div>
<div className="timer-btns">
<button className=â€œaction-btn btn-secondary timer-btnâ€ onClick={() => setRunning((r) => !r)}>
{running ? â€œâ¸ ä¸€æ™‚åœæ­¢â€ : â€œâ–¶ ã‚¹ã‚¿ãƒ¼ãƒˆâ€}
</button>
<button className=â€œaction-btn btn-secondary timer-btnâ€ onClick={() => { setRunning(false); setTimer(0); }}>ãƒªã‚»ãƒƒãƒˆ</button>
</div>
<label>ä»Šå›èª­ã‚“ã ãƒšãƒ¼ã‚¸æ•°</label>
<input className=â€œinputâ€ type=â€œnumberâ€ placeholder=â€œä¾‹ï¼š30â€ value={sessionForm.pages} onChange={(e) => setSessionForm((f) => ({ â€¦f, pages: e.target.value }))} />
<label>ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰</label>
<input className=â€œinputâ€ placeholder=â€œæ„Ÿæƒ³ã‚„æ°—ã¥ããªã©â€ value={sessionForm.notes} onChange={(e) => setSessionForm((f) => ({ â€¦f, notes: e.target.value }))} />
<button className="action-btn btn-primary" onClick={saveSession}>è¨˜éŒ²ã‚’ä¿å­˜</button>
</div>
</div>
);
}

if (view === â€œdetailâ€ && selectedBook) {
const { totalReadTime, readPages, progress } = getStats(selectedBook);
const sessions = [â€¦selectedBook.sessions].reverse();
return (
<div className="app">
<style>{css}</style>
<div className="header">
<button className=â€œback-btnâ€ onClick={() => setView(â€œlistâ€)} style={{ marginBottom: 10 }}>â† ä¸€è¦§ã¸</button>
<div className="header-sub">{selectedBook.author || â€œè‘—è€…ä¸æ˜â€}</div>
<div className=â€œheader-titleâ€ style={{ fontSize: 20 }}>{selectedBook.title}</div>
</div>
<div className="content">
<div className=â€œprogress-bar-bgâ€ style={{ height: 6 }}>
<div className=â€œprogress-bar-fillâ€ style={{ width: `${progress}%`, height: 6 }} />
</div>
<div className="progress-label">
<span>{readPages} / {selectedBook.totalPages} ãƒšãƒ¼ã‚¸</span>
<span>{Math.round(progress)}%</span>
</div>
<div className="section-title">çµ±è¨ˆ</div>
<div className="stat-grid">
<div className="stat-box"><div className="stat-val">{formatTime(totalReadTime)}</div><div className="stat-key">ç·èª­æ›¸æ™‚é–“</div></div>
<div className="stat-box"><div className="stat-val">{selectedBook.sessions.length}</div><div className="stat-key">èª­æ›¸å›æ•°</div></div>
<div className="stat-box"><div className="stat-val">{formatDate(selectedBook.startDate)}</div><div className="stat-key">èª­æ›¸é–‹å§‹æ—¥</div></div>
<div className="stat-box"><div className="stat-val">{formatDate(selectedBook.endDate)}</div><div className="stat-key">èª­æ›¸çµ‚äº†æ—¥</div></div>
</div>
<div style={{ marginTop: 20 }}>
<button className=â€œaction-btn btn-primaryâ€ onClick={() => { setSessionForm({ pages: â€œâ€, notes: â€œâ€ }); setTimer(0); setRunning(false); setView(â€œsessionâ€); }}>ğŸ“– èª­æ›¸ã‚’è¨˜éŒ²ã™ã‚‹</button>
</div>
{sessions.length > 0 && (
<>
<div className="section-title">èª­æ›¸å±¥æ­´</div>
{sessions.map((s, i) => (
<div className="session-item" key={i}>
<div className="session-date">{formatDate(s.date)}</div>
<div className="session-stats">{s.pages}ãƒšãƒ¼ã‚¸èª­äº†ãƒ»{formatTime(s.duration)}</div>
{s.notes && <div style={{ fontSize: 12, color: â€œ#a0906eâ€, marginTop: 4 }}>{s.notes}</div>}
</div>
))}
</>
)}
<button className=â€œaction-btn btn-dangerâ€ onClick={() => deleteBook(selectedBook.id)}>ã“ã®æœ¬ã‚’å‰Šé™¤</button>
</div>
</div>
);
}

return (
<div className="app">
<style>{css}</style>
<div className="header">
<div className="header-sub">My Library</div>
<div className="header-title">èª­æ›¸è¨˜éŒ²</div>
</div>
<div className="content">
{books.length === 0 ? (
<div className="empty">
<div className="empty-icon">ğŸ“š</div>
<div>ã¾ã æœ¬ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“<br />å³ä¸‹ã®ï¼‹ãƒœã‚¿ãƒ³ã‹ã‚‰è¿½åŠ ã—ã¾ã—ã‚‡ã†</div>
</div>
) : books.map((book) => {
const { readPages, progress } = getStats(book);
const done = book.endDate || readPages >= book.totalPages;
return (
<div className=â€œbook-cardâ€ key={book.id} onClick={() => { setSelectedId(book.id); setView(â€œdetailâ€); }}>
<div style={{ display: â€œflexâ€, alignItems: â€œflex-startâ€, justifyContent: â€œspace-betweenâ€ }}>
<div className=â€œbook-titleâ€ style={{ flex: 1 }}>{book.title}</div>
<span className={`badge ${done ? "badge-done" : "badge-reading"}`}>{done ? â€œèª­äº†â€ : â€œèª­ä¸­â€}</span>
</div>
{book.author && <div className="book-author">{book.author}</div>}
<div className="progress-bar-bg">
<div className=â€œprogress-bar-fillâ€ style={{ width: `${progress}%` }} />
</div>
<div className="progress-label">
<span>{readPages} / {book.totalPages} ãƒšãƒ¼ã‚¸</span>
<span>{Math.round(progress)}%</span>
</div>
</div>
);
})}
</div>
<button className=â€œfabâ€ onClick={() => setView(â€œaddâ€)}>ï¼‹</button>
</div>
);
}

ReactDOM.createRoot(document.getElementById(â€œrootâ€)).render(<App />);
</script>

</body>
</html>
